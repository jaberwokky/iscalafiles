<?xml version='1.0' encoding='windows-1251'?>
<!DOCTYPE POWERMART SYSTEM "powrmart.dtd">
<POWERMART REPOSITORY_VERSION="182.91" CREATION_DATE="05/25/2016 02:04:27"><REPOSITORY DATABASETYPE="Oracle" CODEPAGE="MS1251" VERSION="182" NAME="RS_DEV"><FOLDER UUID="3e7d60e6-bf49-4526-99eb-ce21a42c6fa4" PERMISSIONS="rwx---r--" DESCRIPTION="" SHARED="NOTSHARED" OWNER="Administrator" GROUP="" NAME="DM_SAS_MA"><MAPPING DESCRIPTION="" ISVALID="YES" NAME="m_PREDM_CNTRP_REL" OBJECTVERSION="1" VERSIONNUMBER="1"><TRANSFORMATION DESCRIPTION="" NAME="SQ_CA_CLIENT_INFORMATION" OBJECTVERSION="1" REUSABLE="NO" TYPE="Source Qualifier" VERSIONNUMBER="1"><TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="EID" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="50" SCALE="0"/><TRANSFORMFIELD DATATYPE="double" DEFAULTVALUE="" DESCRIPTION="" NAME="CNTRP_RK" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="0"/><TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="CNTRP_CCD" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="30" SCALE="0"/><TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="PREV_EID" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="30" SCALE="0"/><TRANSFORMFIELD DATATYPE="date/time" DEFAULTVALUE="" DESCRIPTION="" NAME="EFFECTIVE_FROM_DT" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="29" SCALE="9"/><TABLEATTRIBUTE NAME="Sql Query" VALUE="with   nat_pers as   (     select       /*+parallel(8)*/       distinct cnp.counterparty_rk counterparty_rk,       cnp.last_name last_name,       cnp.first_name first_name,       cnp.middle_name middle_name,       cnp.sex sex,       cnp.birth_date birth_date,       cnp.country_ccd country_ccd     from       dds.counterparty_natural_person cnp     cross join xat.madm_cntrp_last_name_fltr ta     where       cnp.source_system_ccd = '007'       and cnp.valid_to_dttm = dt_inf(1)       and       (         cnp.first_name not like ta.filter         or cnp.last_name not like ta.filter         or cnp.middle_name not like ta.filter       )   )   ,   conter_type as   (     select       /*+parallel(8) materialize*/       rk     from       dds.xref_counterparty_type     where       ccd in       (         select           type         from           xat.counterparty_type_natural       )       and valid_to_dttm = dt_inf(1)   )   ,   client as -- зерно + основная информация по клиенту   (     select       /*+parallel(8) full(p) full(ic)*/       regexp_replace(ic.nk_ccd, '^\w+.#.') as eid, --EID       cnp.counterparty_rk as cntrp_rk --CNTRP_RK     from       idmap.counterparty ic     join nat_pers cnp     on       ic.rk = cnp.counterparty_rk     join dds.counterparty p     on       cnp.counterparty_rk = p.counterparty_rk       and p.source_system_ccd = '007'       and p.valid_to_dttm = dt_inf(1)     join conter_type t     on       p.counterparty_type_rk = t.rk     where       ic.source_system_ccd = '007'   ) select   /*+parallel(8) full(cu)*/   c.eid,   c.cntrp_rk,   cu.cntrp_rk,   cu.cntrp_ccd,   case     when cu.source_system_ccd = '007'     then substr(cu.cntrp_ccd, 5)     when cu.source_system_ccd = '001'     then null   end as prev_eid,   trunc(cu.effective_from_dt) as effective_from_dt from   client c join dds.cntrp_unification cu on   c.cntrp_rk = cu.cntrp_rk   and cu.source_system_ccd in('001', '007')   and cu.valid_to_dttm = dt_inf(1)   and cu.effective_to_dt = dt_inf(1)"/><TABLEATTRIBUTE NAME="User Defined Join" VALUE=""/><TABLEATTRIBUTE NAME="Source Filter" VALUE=""/><TABLEATTRIBUTE NAME="Number Of Sorted Ports" VALUE="0"/><TABLEATTRIBUTE NAME="Tracing Level" VALUE="Normal"/><TABLEATTRIBUTE NAME="Select Distinct" VALUE="NO"/><TABLEATTRIBUTE NAME="Is Partitionable" VALUE="NO"/><TABLEATTRIBUTE NAME="Pre SQL" VALUE=""/><TABLEATTRIBUTE NAME="Post SQL" VALUE=""/><TABLEATTRIBUTE NAME="Output is deterministic" VALUE="NO"/><TABLEATTRIBUTE NAME="Output is repeatable" VALUE="Never"/></TRANSFORMATION><TRANSFORMATION VERSIONNUMBER="1" TYPE="Expression" REUSABLE="NO" OBJECTVERSION="1" NAME="EXP_SYSFIELDS" DESCRIPTION=""><TRANSFORMFIELD SCALE="0" PRECISION="15" PORTTYPE="INPUT/OUTPUT" PICTURETEXT="" NAME="EID" EXPRESSIONTYPE="GENERAL" EXPRESSION="EID" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="double"/><TRANSFORMFIELD SCALE="0" PRECISION="15" PORTTYPE="INPUT/OUTPUT" PICTURETEXT="" NAME="CNTRP_RK" EXPRESSIONTYPE="GENERAL" EXPRESSION="CNTRP_RK" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="double"/><TRANSFORMFIELD SCALE="0" PRECISION="30" PORTTYPE="INPUT/OUTPUT" PICTURETEXT="" NAME="CNTRP_CCD" EXPRESSIONTYPE="GENERAL" EXPRESSION="CNTRP_CCD" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="string"/><TRANSFORMFIELD SCALE="0" PRECISION="15" PORTTYPE="INPUT/OUTPUT" PICTURETEXT="" NAME="PREV_EID" EXPRESSIONTYPE="GENERAL" EXPRESSION="PREV_EID" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="double"/><TRANSFORMFIELD SCALE="9" PRECISION="29" PORTTYPE="INPUT/OUTPUT" PICTURETEXT="" NAME="EFFECTIVE_FROM_DT" EXPRESSIONTYPE="GENERAL" EXPRESSION="EFFECTIVE_FROM_DT" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="date/time"/><TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="$$mpSourceSystemCCD" EXPRESSIONTYPE="GENERAL" NAME="SOURCE_SYSTEM_CCD" PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="3" SCALE="0"/><TRANSFORMFIELD DATATYPE="date/time" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="SYSTIMESTAMP()" EXPRESSIONTYPE="GENERAL" NAME="PROCESSED_DTTM" PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="29" SCALE="9"/><TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="'N'" EXPRESSIONTYPE="GENERAL" NAME="DELETED_FLAG" PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/><TRANSFORMFIELD DATATYPE="double" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="$$spDWHJobID" EXPRESSIONTYPE="GENERAL" NAME="DWH_JOB_ID" PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="15" SCALE="0"/><TABLEATTRIBUTE VALUE="Normal" NAME="Tracing Level"/><METADATAEXTENSION VENDORNAME="INFORMATICA" VALUE="" NAME="Author" MAXLENGTH="256" ISSHAREWRITE="NO" ISSHAREREAD="NO" ISREUSABLE="YES" ISCLIENTVISIBLE="YES" ISCLIENTEDITABLE="YES" DOMAINNAME="User Defined Metadata Domain" DESCRIPTION="Разработчик, создавший объект" DATATYPE="STRING"/><METADATAEXTENSION VENDORNAME="INFORMATICA" VALUE="" NAME="Creation Date" MAXLENGTH="10" ISSHAREWRITE="NO" ISSHAREREAD="NO" ISREUSABLE="YES" ISCLIENTVISIBLE="YES" ISCLIENTEDITABLE="YES" DOMAINNAME="User Defined Metadata Domain" DESCRIPTION="Дата создания\последнего обновления объекта в формате DD\MM\YYYY" DATATYPE="STRING"/><METADATAEXTENSION VENDORNAME="INFORMATICA" VALUE="" NAME="Doc Link" MAXLENGTH="256" ISSHAREWRITE="NO" ISSHAREREAD="NO" ISREUSABLE="YES" ISCLIENTVISIBLE="YES" ISCLIENTEDITABLE="YES" DOMAINNAME="User Defined Metadata Domain" DESCRIPTION="Ссылка или название документа, в котором описаны свойства соответвующего объекта" DATATYPE="STRING"/><METADATAEXTENSION VENDORNAME="INFORMATICA" VALUE="" NAME="GIT Info" MAXLENGTH="256" ISSHAREWRITE="NO" ISSHAREREAD="NO" ISREUSABLE="YES" ISCLIENTVISIBLE="YES" ISCLIENTEDITABLE="YES" DOMAINNAME="User Defined Metadata Domain" DESCRIPTION="Информация из Git репозитория: Branch, Tag, Commit" DATATYPE="STRING"/></TRANSFORMATION><INSTANCE DESCRIPTION="" NAME="CNTRP_REL" TRANSFORMATION_NAME="CNTRP_REL" TRANSFORMATION_TYPE="Target Definition" TYPE="TARGET"/><INSTANCE DBDNAME="IDMAP" DESCRIPTION="" NAME="COUNTERPARTY" TRANSFORMATION_NAME="COUNTERPARTY" TRANSFORMATION_TYPE="Source Definition" TYPE="SOURCE"/><INSTANCE DBDNAME="DDS" DESCRIPTION="" NAME="COUNTERPARTY_NATURAL_PERSON" TRANSFORMATION_NAME="COUNTERPARTY_NATURAL_PERSON" TRANSFORMATION_TYPE="Source Definition" TYPE="SOURCE"/><INSTANCE DESCRIPTION="" NAME="SQ_CA_CLIENT_INFORMATION" REUSABLE="NO" TRANSFORMATION_NAME="SQ_CA_CLIENT_INFORMATION" TRANSFORMATION_TYPE="Source Qualifier" TYPE="TRANSFORMATION"><ASSOCIATED_SOURCE_INSTANCE NAME="COUNTERPARTY"/><ASSOCIATED_SOURCE_INSTANCE NAME="COUNTERPARTY_NATURAL_PERSON"/><ASSOCIATED_SOURCE_INSTANCE NAME="CNTRP_UNIFICATION"/></INSTANCE><INSTANCE DBDNAME="DDS" DESCRIPTION="" NAME="CNTRP_UNIFICATION" TRANSFORMATION_NAME="CNTRP_UNIFICATION" TRANSFORMATION_TYPE="Source Definition" TYPE="SOURCE"/><INSTANCE DESCRIPTION="" NAME="EXP_SYSFIELDS" REUSABLE="NO" TRANSFORMATION_NAME="EXP_SYSFIELDS" TRANSFORMATION_TYPE="Expression" TYPE="TRANSFORMATION"/><CONNECTOR FROMFIELD="EID" FROMINSTANCE="EXP_SYSFIELDS" FROMINSTANCETYPE="Expression" TOFIELD="EID" TOINSTANCE="CNTRP_REL" TOINSTANCETYPE="Target Definition"/><CONNECTOR FROMFIELD="CNTRP_RK" FROMINSTANCE="EXP_SYSFIELDS" FROMINSTANCETYPE="Expression" TOFIELD="CNTRP_RK" TOINSTANCE="CNTRP_REL" TOINSTANCETYPE="Target Definition"/><CONNECTOR FROMFIELD="CNTRP_CCD" FROMINSTANCE="EXP_SYSFIELDS" FROMINSTANCETYPE="Expression" TOFIELD="CNTRP_CCD" TOINSTANCE="CNTRP_REL" TOINSTANCETYPE="Target Definition"/><CONNECTOR FROMFIELD="PREV_EID" FROMINSTANCE="EXP_SYSFIELDS" FROMINSTANCETYPE="Expression" TOFIELD="PREV_EID" TOINSTANCE="CNTRP_REL" TOINSTANCETYPE="Target Definition"/><CONNECTOR FROMFIELD="EFFECTIVE_FROM_DT" FROMINSTANCE="EXP_SYSFIELDS" FROMINSTANCETYPE="Expression" TOFIELD="EFFECTIVE_FROM_DT" TOINSTANCE="CNTRP_REL" TOINSTANCETYPE="Target Definition"/><CONNECTOR FROMFIELD="NK_CCD" FROMINSTANCE="COUNTERPARTY" FROMINSTANCETYPE="Source Definition" TOFIELD="EID" TOINSTANCE="SQ_CA_CLIENT_INFORMATION" TOINSTANCETYPE="Source Qualifier"/><CONNECTOR FROMFIELD="COUNTERPARTY_RK" FROMINSTANCE="COUNTERPARTY_NATURAL_PERSON" FROMINSTANCETYPE="Source Definition" TOFIELD="CNTRP_RK" TOINSTANCE="SQ_CA_CLIENT_INFORMATION" TOINSTANCETYPE="Source Qualifier"/><CONNECTOR FROMFIELD="CNTRP_CCD" FROMINSTANCE="CNTRP_UNIFICATION" FROMINSTANCETYPE="Source Definition" TOFIELD="CNTRP_CCD" TOINSTANCE="SQ_CA_CLIENT_INFORMATION" TOINSTANCETYPE="Source Qualifier"/><CONNECTOR FROMFIELD="CNTRP_CCD" FROMINSTANCE="CNTRP_UNIFICATION" FROMINSTANCETYPE="Source Definition" TOFIELD="PREV_EID" TOINSTANCE="SQ_CA_CLIENT_INFORMATION" TOINSTANCETYPE="Source Qualifier"/><CONNECTOR FROMFIELD="EFFECTIVE_FROM_DT" FROMINSTANCE="CNTRP_UNIFICATION" FROMINSTANCETYPE="Source Definition" TOFIELD="EFFECTIVE_FROM_DT" TOINSTANCE="SQ_CA_CLIENT_INFORMATION" TOINSTANCETYPE="Source Qualifier"/><CONNECTOR FROMFIELD="CNTRP_RK" FROMINSTANCE="SQ_CA_CLIENT_INFORMATION" FROMINSTANCETYPE="Source Qualifier" TOFIELD="CNTRP_RK" TOINSTANCE="EXP_SYSFIELDS" TOINSTANCETYPE="Expression"/><CONNECTOR FROMFIELD="CNTRP_CCD" FROMINSTANCE="SQ_CA_CLIENT_INFORMATION" FROMINSTANCETYPE="Source Qualifier" TOFIELD="CNTRP_CCD" TOINSTANCE="EXP_SYSFIELDS" TOINSTANCETYPE="Expression"/><CONNECTOR FROMFIELD="EFFECTIVE_FROM_DT" FROMINSTANCE="SQ_CA_CLIENT_INFORMATION" FROMINSTANCETYPE="Source Qualifier" TOFIELD="EFFECTIVE_FROM_DT" TOINSTANCE="EXP_SYSFIELDS" TOINSTANCETYPE="Expression"/><CONNECTOR FROMFIELD="EID" FROMINSTANCE="SQ_CA_CLIENT_INFORMATION" FROMINSTANCETYPE="Source Qualifier" TOFIELD="EID" TOINSTANCE="EXP_SYSFIELDS" TOINSTANCETYPE="Expression"/><CONNECTOR FROMFIELD="PREV_EID" FROMINSTANCE="SQ_CA_CLIENT_INFORMATION" FROMINSTANCETYPE="Source Qualifier" TOFIELD="PREV_EID" TOINSTANCE="EXP_SYSFIELDS" TOINSTANCETYPE="Expression"/><TARGETLOADORDER ORDER="1" TARGETINSTANCE="CNTRP_REL"/><MAPPINGVARIABLE USERDEFINED="YES" SCALE="0" PRECISION="3" NAME="$$mpSourceSystemCCD" ISPARAM="YES" ISEXPRESSIONVARIABLE="NO" DESCRIPTION="" DEFAULTVALUE="&quot;100&quot;" DATATYPE="string"/><MAPPINGVARIABLE USERDEFINED="YES" SCALE="0" PRECISION="10" NAME="$$spDwhJobID" ISPARAM="YES" ISEXPRESSIONVARIABLE="NO" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="integer"/><MAPPINGVARIABLE USERDEFINED="YES" SCALE="9" PRECISION="29" NAME="$$mpEffectiveFrom" ISPARAM="YES" ISEXPRESSIONVARIABLE="NO" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="date/time"/><MAPPINGVARIABLE USERDEFINED="YES" SCALE="9" PRECISION="29" NAME="$$mpEffectiveTo" ISPARAM="YES" ISEXPRESSIONVARIABLE="NO" DESCRIPTION="" DEFAULTVALUE="" DATATYPE="date/time"/><ERPINFO/></MAPPING></FOLDER></REPOSITORY></POWERMART>